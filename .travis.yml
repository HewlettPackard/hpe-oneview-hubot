sudo: true
dist: trusty
language: node_js
node_js:
- '6'
- '7'
before_script:
- npm install
script:
- npm test
after_success: npm run coverage
jobs:
  include:
  - stage: build docker image
    script:
    - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
    - docker build -f Dockerfile-core -t docker.io/hewlettpackardenterprise/core-hubot:latest .
    - docker images
    - docker tag hewlettpackardenterprise/core-hubot docker.io/hewlettpackardenterprise/core-hubot:latest
    - docker push docker.io/hewlettpackardenterprise/core-hubot:latest
    - docker build -t docker.io/hewlettpackardenterprise/hpe-oneview-hubot:latest .
    - docker images
    - docker tag hewlettpackardenterprise/hpe-oneview-hubot docker.io/hewlettpackardenterprise/hpe-oneview-hubot:latest
    - docker push docker.io/hewlettpackardenterprise/hpe-oneview-hubot:latest
env:
  global:
  - secure: FO4xDrOF+8y34LYYyFWvzRGiJJcPtOb7Kbnvet9voXEQhswK36Mr2q6/AMbnLkHpjB/gm+Etb2MXsHFLjVPpbTKPSf91H8VXE3u9bZwCwxnSJicBPo+UAGHgtIuEXa1z5rl8nSIUhrQR1GY9eD8ftDJZNhUA5EghuU00P4eN4yaC/iYGQ7j769VebBalyw4472BHn9fvF3N49uFT2hEvYeJ0iwJD6nazm63PP+a+sSTFtJmMhJU8htnXfyepJm3FJj6Wlv50iigXE8V5UqaTZXARTvW2dmV2WTim7H+GAeAKl8v3/f9k+uQNAcpmYcWetRVFEl+jPAHTHuUcAdwFWPYEOkbLp/XHiPziZauiasH6PJMPOiJmeZiy/RVNcaW/qOVngTelLTg0xRmhnxmupKExLIbDPAFS5pmQCU5Fhesl3vyJ8Zd7hhsOFbE+DGJ5aEpkj82yG9yjgcdNRvImfJ96qlpgKZQY2JeVP2IaMNM8rauy41s7oXNEd0IbpcX1PASZ63d8ZrPfBg/bpRLEEwg+icHe4OOO+K9AD3EA4fIItiPk/v3DaU1YLvvONL8ichaKeH4R1zrwV1ydg7eV4FBtE/U3pUPrOXwKVHeMeKsu5psTvGw15jI+Y4WZzUDiiISIk1/RfriNxbLqLtHcyOvejQ/N0GFdNz1SWZ312Uk=
  - secure: lAPhUz3yoEj8VEJIRBMimyvcYak9GlJg8pyXU02DnI+5IxS2+gMvhJ41cqGxWHPkFdZHk1p9DA1q8Ih0Y1Jnq4zgQ5sJDZ7WC2VEIFfPc8Vtlo01jSZQ+hgP33WmFaUhbj12W1VR1Oi0PPH6ygAaHJWi/g9FFMk/6Eki8KFFjUgLm1uRWMK99kzsn8avtPARDI/Zc8dv9k0puyoJevzeMZNQHCLIkFKUJdauaahC3Mvfld8NacF+Y5e9ETGrC3/lSHVWBaPKLr1j+ouQ5u5Ec+r7UwaUJszeFapy9lNVIV65MbQ0qTR4REJI5dDFkfGDivT3MhTwV7JsM/jmecR3rDjpHRCWkDxDmp0z9xN2ciUebRn2vnsh7bj65yDXwdshWbnRbHjHTdXCufi9htlqq0HKjBrlumck/60omuMzM3HcImKsX8skVRqOjy6S16AECxmofBWF4HGwUxnI2NwQvgTcSIhYENPDzEofkpfxZpcwfwnpDxh/zbErG6+ZH5po0RvrIOU6UruBbkdOR4h2wJW8BwgCHlFJlVFM1/6LOMuYA3W+B5qcoAmSLva2v+VUPyW+tyZTNeNRUv5CGe0mAqDcIvmrPm2ZK9JeyKMqme1bQWIhX0ffke4Wosj9o0ykUjbAQb2agB+WGW2yPEGiHWwPBa1ufd1uf2iCEV6PsKE=
